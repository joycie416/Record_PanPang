# ì»¤íŠ¼ì½œ ğŸ­ [outsourcing-project]

[ë©”ì¸í˜ì´ì§€] ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-09-20 á„‹á…©á„’á…® 4 45 08](https://github.com/user-attachments/assets/6e929713-6ba0-4e00-b423-bd1f2cec40a2)

[ìƒì„¸í˜ì´ì§€] <img width="1224" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-09-20 á„‹á…©á„’á…® 4 13 01" src="https://github.com/user-attachments/assets/1d4c5324-ec12-4c0b-8e99-024fde72e82a">

[ì»¤ë®¤ë‹ˆí‹° í˜ì´ì§€] <img width="1105" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-09-22 á„‹á…©á„Œá…¥á†« 12 08 43" src="https://github.com/user-attachments/assets/a99ff3df-c371-4eb5-8d57-cff8567bd4d5">

[ì¹´í…Œê³ ë¦¬ í˜ì´ì§€] <img width="1224" alt="í™”ë©´ìº¡ì²˜_2024-09-20_192523" src="src/assets/í™”ë©´ìº¡ì²˜_2024-09-20_192523.png">

---

## íŒ€ ì†Œê°œ

[ë‚´ì¼ë°°ì›€ìº í”„] 2ì¡°

## ğŸ‘¨â€ğŸ« í”„ë¡œì íŠ¸ ì†Œê°œ

### ìŒì•…ì„ ê³µìœ í•˜ëŠ” í˜ì´ì§€

### ğŸš© í”„ë¡œì íŠ¸ ê°œìš”

- **í”„ë¡œì íŠ¸ëª…** &nbsp; :&nbsp; **Record PanPang**
- **ì§„í–‰ ê¸°ê°„** &nbsp;: &nbsp; **24.10.10 ~ 24.10.17**

---

### ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ íŒ€ì› ì†Œê°œ

|   ì†¡ì§„ìš°   |      ì´ë³´ì˜      |        ì •ìˆ˜í¬        |  ì¡°ì•„ì˜  |         ì¡°í•´ì¸         |
| :--------: | :--------------: | :------------------: | :------: | :--------------------: |
|  **íŒ€ì›**  |     **íŒ€ì›**     |       **íŒ€ì›**       | **íŒ€ì›** |        **íŒ€ì¥**        |
| ëŒ“ê¸€ ì „ë°˜ | ìŒì•… ê²€ìƒ‰ ê¸°ëŠ¥ | ìŒì•… í”Œë ˆì´ì–´, ì¢‹ì•„ìš” | ê²Œì‹œê¸€ ì „ë°˜ | íšŒì›ê°€ì…/ë¡œê·¸ì¸, í”„ë¡œí•„ ìˆ˜ì • |

---

## ğŸ“š STACKS

<div align=Left>
<img src="https://img.shields.io/badge/react-61DAFB?style=for-the-badge&logo=react&logoColor=black">
<img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white">
<img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white">
<img src="https://img.shields.io/badge/typescript-1572B6?style=for-the-badge&logo=typescript&logoColor=white">
<img src="https://img.shields.io/badge/next.js-000000?style=for-the-badge&logo=next.js&logoColor=white">
<img src="https://img.shields.io/badge/TailwindCss-06B6D4?style=for-the-badge&logo=java&logoColor=white">
<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/Notion-000000?style=for-the-badge&logo=Notion&logoColor=white">
<img src="https://img.shields.io/badge/VSCODE-007ACC?style=for-the-badge&logo=visualstudiocode&logoColor=white">
<img src="https://img.shields.io/badge/VERCEL-007ACC?style=for-the-badge&logo=VERCEL&logoColor=white">
<img src="https://img.shields.io/badge/SLACK-green?style=for-the-badge&logo=SLACK&logoColor=white">
</div>

---

## ì„¤ì¹˜ íŒ¨í‚¤ì§€

- í”„ë¡œì íŠ¸ ì„¸íŒ… : npx create-next-app@latest
  - tailwindcss í¬í•¨
  - ì‹¤í–‰ : yarn dev
- tanstack query ì„¤ì¹˜ : yarn add @tanstack/react-query
  - tailwind.config.js íŒŒì¼ ìƒì„± : npx tailwindcss init -p
- zustand ì„¤ì¹˜ : yarn add zustand
- shadcn/ui(ìºëŸ¬ì…€ ë¼ì´ë¸ŒëŸ¬ë¦¬) : yarn add shadcn/ui
  - gray, cssVariables X

---

## âœ”ï¸ Code Convention

- ES Lint , prettier ì‚¬ìš©
- ì»´í¬ë„ŒíŠ¸ì¼ ê²½ìš°ì—ë§Œ .jsxí™•ì¥ì ì‚¬ìš©
- customHookì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° : use + í•¨ìˆ˜ëª…
- Propsì˜ ê²½ìš°: on (onClick ë“±ë“±)
- í•¨ìˆ˜ì¸ ê²½ìš°: handle (handleClick ë“±ë“±)
- ìƒìˆ˜ : ëª¨ë‘ ëŒ€ë¬¸ì ìŠ¤ë„¤ì´í¬ ì¼€ì´ìŠ¤(snake_case) ì˜ˆì‹œ) SNAKE_CASE
- js(ë³€ìˆ˜, í•¨ìˆ˜, ì¸ìŠ¤í„´ìŠ¤) : ì¹´ë©œ ì¼€ì´ìŠ¤(camelCase) ì˜ˆì‹œ) const createMovie = [];
- css, html : ì¼€ë°¥ ì¼€ì´ìŠ¤(kebab-case) ì˜ˆì‹œ)Â `<div class="movie-items"></div>`
- image ëª… : ì¼€ë°¥ ì¼€ì´ìŠ¤(kebab-case) ì˜ˆì‹œ) movie-img.jpg
- ì£¼ì„ ìµœëŒ€í•œ í™œìš©í•˜ê¸° : í•´ë‹¹ ì½”ë“œ ì œëª©, ì„¤ëª… ê°„ë‹¨í•˜ê²Œ ì ì–´ë†“ê¸°
- ì•½ì¹­ì€ ë˜ë„ë¡ ì‚¬ìš©í•˜ì§€ ì•Šê¸°

## âœ”ï¸ Git Commit Convention

ì‘ì—… íƒ€ì… ì‘ì—…ë‚´ìš©

- update : í•´ë‹¹ íŒŒì¼ì— ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ìƒê¹€
- add : ì—†ë˜ íŒŒì¼ì„ ìƒì„±í•¨, ì´ˆê¸° ì„¸íŒ…
- bugfix : ë²„ê·¸ ìˆ˜ì •
- refactor : ì½”ë“œ ë¦¬íŒ©í† ë§
- fix : ì½”ë“œ ìˆ˜ì •
- move : íŒŒì¼ ì˜®ê¹€/ì •ë¦¬
- del : ê¸°ëŠ¥/íŒŒì¼ì„ ì‚­ì œ
- test : í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±
- style : css
- gitfix : gitignore ìˆ˜ì •
- script : package.json ë³€ê²½(npm ì„¤ì¹˜ ë“±)

## ğŸ—‚ï¸ ê¸°ëŠ¥ ì„¤ëª…

[ì˜ˆì‹œ]

- ì˜¤ëŠ˜ ì§„í–‰ ì¤‘ì¸ ê³µì—° ì¤‘ ëœë¤ìœ¼ë¡œ 8ê°œë¥¼ ì„ íƒí•´ ìºëŸ¬ì…€ ì ìš© ([Embla ë¼ì´ë¸ŒëŸ¬ë¦¬](https://www.embla-carousel.com/get-started/) ì‚¬ìš©)
- ì˜¤ëŠ˜ ì§„í–‰ ì¤‘ì¸ ê³µì—°ì„ ìºëŸ¬ì…€ í•˜ë‹¨ì— ì£¼ì œë³„ë¡œ ë³´ì—¬ì¤Œ

1. ì˜¤ëŠ˜ ì§„í–‰ ì¤‘ì¸ ê³µì—° ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°

```jsx
// playApi.js
// í˜„ì¬ ì§„í–‰ì¤‘ì¸ ê³µì—° ì •ë³´ ë“±ë¡ëœ ìˆœìœ¼ë¡œ ìµœëŒ€ 1000ê°œ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
const BASE_URL = "http://kopis.or.kr/openApi/restful/pblprfr";
const KOPIS_KEY = import.meta.env.VITE_KOPIS_KEY;

const playApi = axios.create({ baseURL: BASE_URL });

export const getData = async () => {
  try {
    const { data } = await playApi.get("/", {
      params: {
        service: KOPIS_KEY,
        stdate: getDateString(), // ì˜¤ëŠ˜ ë‚ ì§œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
        eddate: getDateString(),
        rows: 1000,
        cpage: 1,
      },
    });
    return parseXMLToJSON(data).dbs.db;
  } catch (error) {
    console.error("Error fetching performance details:", error);
    throw new Error("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  }
};
```

```jsx
// MainPage.jsx
// ê³µì—° ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
const {
  data: mainData,
  isPending,
  isError,
} = useQuery({
  queryKey: ["main-data"],
  queryFn: getData,
});
```

2. ëœë¤ìœ¼ë¡œ 8ê°œ ì„ íƒí•´ ìºëŸ¬ì…€ë¡œ ë³´ì—¬ì£¼ê¸°

```jsx
// Embla.jsx
// MainPage.jsxì—ì„œ propìœ¼ë¡œ ë°ì´í„° ì „ë‹¬ ë°›ìŒ
const Embla = ({ data }) => {
  const [emblaRef] = useEmblaCarousel({ loop: true }, [
    Autoplay({ stopOnMouseEnter: true, stopOnInteraction: false }),
  ]);

  const indices = []; // ëœë¤ ì¸ë±ìŠ¤ ì €ì¥
  while (indices.length < 8) {
    let tmp = Math.floor(data.length * Math.random());
    if (indices.includes(tmp)) {
      continue;
    } else {
      indices.push(tmp);
    }
  }
  const carousel = indices.map((idx) => data[idx]);

  return (
    <div className="embla" ref={emblaRef}>
      <div className="embla__container">
        {carousel &&
          [0, 2, 4, 6].map(
            (
              i // ê° ìŠ¬ë¼ì´ë“œì— ë‘ê°œì”© ë³´ì—¬ì¤Œ
            ) => (
              <Slide play={[carousel[i], carousel[i + 1]]} key={`slide-${i}`} />
            )
          )}
      </div>
    </div>
  );
};
```

3. ì¥ë¥´ë³„ë¡œ ë¶„ë¥˜ëœ ê³µì—° ë³´ì—¬ì£¼ê¸°

```jsx
// Genre.jsx
// MainPage.jsxì—ì„œ propìœ¼ë¡œ ë°›ì€ ë°ì´í„°ë¥¼ ì¥ë¥´ì— ë”°ë¼ filterí•´ GenreDivì— ë³´ì—¬ì¤Œ
const Genre = ({data}) => {
  const [clicked, setClicked] = useState(0);
  const genreArray = Object.values(genreCodes);


  return (
      <div>
        <div>
          {
            genreArray..map((item, idx) => (
              <GenreButton idx={idx} clicked={clicked} setClicked={setClicked} key={item}>
                {item}
              </GenreButton>
            ))
          }
        </div>
        <div>
          <GenreDiv plays={data.filter(play => play.genrenm === genreArray[clicked]).slice(0,10)} idx={clicked}/>
        </div>
      </div>
  )
}
```


---

[í”Œë ˆì´ì–´]


---

[ê²€ìƒ‰]

---

[ê²Œì‹œê¸€]

---

[ëŒ“ê¸€]

---

[ë§ˆì´í˜ì´ì§€]

ì‚¬ìš©ì ì •ë³´ì™€ ì‚¬ìš©ìê°€ ì‘ì„±í•œ ê²Œì‹œê¸€ê³¼ ëŒ“ê¸€, ì¢‹ì•„ìš”í•œ ê²Œì‹œê¸€ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. í”„ë¡œí•„ ìˆ˜ì • ê¸°ëŠ¥

`í”„ë¡œí•„ ìˆ˜ì •í•˜ê¸°` ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ëª¨ë‹¬ì°½ì„ í†µí•´ ì‚¬ìš©ì ì •ë³´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€í™”ë¥¼ ê°ì§€í•  ìˆ˜ ìˆë„ë¡ TanStack Queryë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ ë³€í™”ê°€ ë°œìƒí•˜ë©´ `invalidateQueries`ë¥¼ í†µí•´ ë³€ê²½ëœ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ í•©ë‹ˆë‹¤.

```tsx
// ./src/components/features/mypage/EditProfileModal.tsx

...
const EditProfileModal = ({
  user,
  setShowModal
}: {
  user: User | undefined;
  setShowModal: React.Dispatch<React.SetStateAction<boolean>>;
}) => {

...

  // ì‚¬ìš©ì í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ì‹œ ì •ë³´ ë°”ë¡œ ê°±ì‹ ë˜ë„ë¡
  const queryClient = useQueryClient();
  // ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸ ì„±ê³µ ì‹œ invalidateQueries
  const { mutate: handleUpdateUser } = useMutation({
    mutationFn: () => updateUser(user as User, nickname, profileImg),
    onSuccess: () => {
      queryClient.invalidateQueries({
        queryKey: ["user", "client"]
      });
      queryClient.invalidateQueries({ queryKey: ["post", currentUserId] });
      queryClient.invalidateQueries({ queryKey: ["posts"] });
    }
  });

...

};


```


---

[ë„¤ë¹„ê²Œì´ì…˜ ë°”]

ë¡œê·¸ì¸ ì •ë³´ê°€ ì—†ì„ ì‹œ íšŒì›ê°€ì…, ë¡œê·¸ì¸ ë²„íŠ¼ì´ ìš°ì¸¡ ìƒë‹¨ì— ìœ„ì¹˜í•˜ë©°, ë¡œê·¸ì¸ ì •ë³´ê°€ ìˆì„ ì‹œ ë¡œê·¸ì•„ì›ƒ, ë§ˆì´í˜ì´ì§€ ë²„íŠ¼ê³¼ í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ìš°ì¸¡ ìƒë‹¨ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.

1. Link íƒœê·¸ë¡œ ì—°ê²°í•˜ì—¬ í˜ì´ì§€ ë¡œë”© ìµœì í™”

í˜ì´ì§€ ì •ë³´ë¥¼ ë¯¸ë¦¬ ë¶ˆëŸ¬ì™€ì„œ ì´ë™ ì‹œ ì‹œê°„ì„ ì¤„ì¼ ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤.


```tsx
// ./src/components/features/navbar/ProfileImg.tsx

...

const ProfileImg = () => {

  ...

  const userImg = getPublicUrl("profiles", user?.user_metadata.profile_img);

  return (
    <Link href={"/mypage"} className="min-w-fit min-h-fit rounded-full">
      <Image
        src={userImg}
        alt="í”„ë¡œí•„ ì´ë¯¸ì§€"
        width={40}
        height={40}
        className="w-[40px] h-[40px] border-2 rounded-full aspect-auto object-cover"
      />
    </Link>
  );
};
```


---


---

## ğŸ’¥ Trouble Shooting

[ì˜ˆì‹œ]

ğŸ”¥ ë¬¸ì œì 

1. ê¸°ì¡´ì—ëŠ” ì¥ë¥´ë³„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ë•Œ apiì—ì„œ ê°ê° ë¶ˆëŸ¬ì™”ìœ¼ë‚˜, ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê³¼ì •ì´ ë¶ˆí•„ìš”í•˜ê²Œ ë§ì•„ì§€ëŠ” ë¬¸ì œì ì´ ìˆì—ˆìŒ. ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ë§ì´ ë¶ˆëŸ¬ì˜¨ í›„ propìœ¼ë¡œ ì „ë‹¬í•´ ì‚¬ìš©í•¨.

- ì•„ë˜ëŠ” ì¥ë¥´ë³„ ë°ì´í„°ë¥¼ ê°ê° ë¶ˆëŸ¬ì˜¬ ë•Œ ì‚¬ìš©í•œ ì½”ë“œ (í˜„ì¬ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)

```jsx
// playApi.jsx
// ì¥ë¥´ë³„ ë°ì´í„°ë¥¼ 0ë²ˆì§¸ë¶€í„° 4ë²ˆì§¸ê¹Œì§€ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
export const getGenreData = async (genre) => {
  const { data } = await playApi.get(`?genrenm=${genre}&_start=0&_end=5`);
  return data;
};

const genreArray = Object.values(genreCodes);
// Promise.allì„ ì´ìš©í•´ ë™ì‹œì— ì—¬ëŸ¬ ì¥ë¥´ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
export const getClassifiedData = async () => {
  const responses = Promise.all(genreArray.map((genre) => getGenreData(genre)));
  return responses;
};
```

---

[í”Œë ˆì´ì–´]


---

[ê²€ìƒ‰]

---

[ê²Œì‹œê¸€]

---

[ëŒ“ê¸€]

---

[ë§ˆì´í˜ì´ì§€]

ğŸ”¥ ë¬¸ì œì 

1. ë‹¤ë¥¸ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸í•˜ë©´ ê¸°ì¡´ ì‚¬ìš©ì ì •ë³´ê°€ ë§ˆì´ í˜ì´ì§€ ì‚¬ìš©ì ì •ë³´ì— ì ìš©ë¨.

TanStack Queryë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ auth stateê°€ ë³€ê²½ë˜ë©´ `invalidateQueries`ë¥¼ ì‹¤í–‰í•¨. ì´ë•Œ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ TanStack Queryë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , í•­ìƒ ìƒë‹¨ì— ë…¸ì¶œë˜ì–´ìˆëŠ” client ì»´í¬ë„ŒíŠ¸ê°€ ë„¤ë¹„ê²Œì´ì…˜ ë°”ì˜ í”„ë¡œí•„ ì´ë¯¸ì§€ì´ë¯€ë¡œ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì— `onAuthStateChange`ë¥¼ ì ìš©í•¨.

```tsx
// ./xrc/components/features/navbar/ProfileImg.tsx

const ProfileImg = () => {
  ...

  supabase.auth.onAuthStateChange(() => {
    // ëª¨ë“  auth state ë³€í™”ì— ë”°ë¼ session ë‹¤ì‹œ ì €ì¥
    queryClient.invalidateQueries({ queryKey: ["user", "client"] });
  });

  ...

};
```

---

[ë„¤ë¹„ê²Œì´ì…˜ ë°”]

ğŸ”¥ ë¬¸ì œì 

1. ì‚¬ìš©ì ì •ë³´ ë³€ê²½ ì‹œ í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ê°™ì´ ë°˜ì˜ë˜ì§€ ì•ŠìŒ

TanStack Queryì˜ Provider ë‚´ë¶€ì— í—¤ë”ë¥¼ í¬í•¨ì‹œì¼œ `invalidateQueries`ì˜ ì˜í–¥ì„ ë°›ë„ë¡ í•¨.

```tsx
// ./src/app/layout.tsx

...

export default async function RootLayout({
  children
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en" suppressHydrationWarning>
      <body className={`${geistSans.variable} ${geistMono.variable} antialiased flex flex-col min-h-screen`}>
        <Providers>
          <Header />
          <Background>{children}</Background>
          <Footer />
        </Providers>
      </body>
    </html>
  );
}
```

```tsx
// ./xrc/components/features/navbar/ProfileImg.tsx

const ProfileImg = () => {
  const defaultImg = getPublicUrl("profiles", "default");

  const {
    data: user,
    isLoading,
    isError
  } = useQuery({
    queryKey: ["user", "client"],
    queryFn: () => fetchSessionData()
  });

  supabase.auth.onAuthStateChange(() => {
    // ëª¨ë“  auth state ë³€í™”ì— ë”°ë¼ session ë‹¤ì‹œ ì €ì¥
    queryClient.invalidateQueries({ queryKey: ["user", "client"] });
  });

  ...

};
```

---
